<div class="example-extension-settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>Random Events</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <div class="example-extension_block flex-container">
                <input id="disabled_setting" type="checkbox" />
                <label for="disabled_setting">Disabled</label>
            </div>
            <div class="example-extension_block flex-container">
                <input id="ai_events_setting" type="checkbox" />
                <label for="ai_events_setting">AI Events</label>
            </div>
            <div class="example-extension_block flex-container">
                <select id="eventItems" name="items">
                </select>

                <input type="text" id="newEventItems" placeholder="Enter a new event">
                <button id="newEventItemsButton" onclick="addItem()">Add Event</button>
                <input id="delete_event" type="checkbox" onclick="deleteItem()" />
                <label for="delete_event">Delete Event</label>
                <script>
                    function addItem() {
                        var newItem = document.getElementById("newEventItems").value;
                        if (newItem.trim() !== "") {
                            var select = document.getElementById("eventItems");
                            var option = document.createElement("option");
                            option.value = newItem;  // Preserve case and spaces
                            option.text = newItem;
                            select.add(option);
                            document.getElementById("newEventItems").value = "";
                
                            // Save the added item to local storage
                            saveItem(newItem);
                        }
                    }
                
                    function saveItem(item) {
                        var savedItems = JSON.parse(localStorage.getItem("savedItems")) || [];
                        savedItems.push(item);
                        localStorage.setItem("savedItems", JSON.stringify(savedItems));
                    }
                
                    function deleteItem() {
                        var select = document.getElementById("eventItems");
                        var selectedIndex = select.selectedIndex;
                
                        if (selectedIndex !== -1) {
                            var deletedItem = select.options[selectedIndex].value;
                
                            // Remove the selected item from the dropdown
                            select.remove(selectedIndex);
                
                            // Remove the selected item from the saved items in local storage
                            removeItemFromStorage(deletedItem);
                        }
                    }
                
                    function removeItemFromStorage(item) {
                        var savedItems = JSON.parse(localStorage.getItem("savedItems")) || [];
                        var updatedItems = savedItems.filter(function (savedItem) {
                            return savedItem !== item;
                        });
                        localStorage.setItem("savedItems", JSON.stringify(updatedItems));
                    }
                
                    function getSavedItems() {
                        // Retrieve saved items from local storage
                        return JSON.parse(localStorage.getItem("savedItems")) || [];
                    }
                
                    function saveItemsToFile() {
                        var savedItems = getSavedItems();
                        
                        // Create a Blob containing the saved items as JSON
                        var blob = new Blob([JSON.stringify(savedItems)], { type: 'application/json' });
                
                        // Create a download link and trigger the download
                        var a = document.createElement('a');
                        a.href = URL.createObjectURL(blob);
                        a.download = 'savedItems.json';
                        a.click();
                    }
                
                    function loadSettings() {
                        // Load saved items from local storage
                        var savedItems = getSavedItems();
                
                        // Populate the dropdown with saved items
                        var select = document.getElementById("eventItems");
                        savedItems.forEach(function (item) {
                            var option = document.createElement("option");
                            option.value = item;
                            option.text = item;
                            select.add(option);
                        });
                    }
                
                    // Call loadSettings when the extension is loaded
                    loadSettings();
                </script>
            </div>

            <hr class="sysHR" />
        </div>
    </div>
</div>